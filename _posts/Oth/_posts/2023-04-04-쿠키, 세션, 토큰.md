---
layout: post
title: 쿠키, 세션, 토큰
categories: Log
tags: [Log]
---

### Http의 특성

비연결성, 요청을 처리하고 연결을 끊어 버리기 때문에 서버에 클라이언트의 상태 정보를 남기지 않음.

##### 장점

- 서버의 **자원 낭비**를 줄일 수 있음

##### 단점

- 클라이언트를 **식별**할 수 없음...

### 🍪 쿠키 (Cookie)

**쿠키(Cookie)**란 클라이언트가 어떠한 웹사이트를 방문할 경우, 그 사이트가 사용되고 있는 서버를 통해 클라이언트의 브라우저에 설치되는 작은 기록 파일을 일컫는다.

서버는 클라이언트의 로그인 요청에 대한 응답을 작성할 때, 클라이언트 측에 저장하고 싶은 정보를 응답 헤더의 Set-Cookie에 담는다. (쿠키는 Key-Value 형식의 문자열이다.) 이후 해당 클라이언트는 요청을 보낼 때마다 매번 저장된 쿠키를 요청 헤더의 Cookie에 담아 보낸다. 서버는 쿠키에 담긴 정보를 바탕으로 해당 요청의 클라이언트가 누군지 식별할 수 있다.

##### 쿠키의 단점❎

- 보안에 **취약**하다. (요청 시 쿠키의 값을 그대로 보내어, 유출 및 조작당할 위험이 존재한다.)
- 용량 제한이 있어, 많은 정보를 담을 수 없다.
- 웹 브라우저마다 쿠키에 대한 지원 형태가 다르기에, 브라우저 간 공유가 불가능하다.
- 쿠키의 사이즈가 커질수록 네트워크에 부하가 심해진다.

### 🤝 세션 (Session)

세션(Session)은 웹 애플리케이션에서 사용자 인증(Authentication) 및 권한 부여(Authorization)를 위한 매커니즘 중 하나로, 서버 측에서 상태 정보를 유지하는 기술이다.

웹 애플리케이션에서 사용자가 로그인하면, 서버는 사용자를 구분하기 위한 고유한 세션 ID를 생성하고, 이를 클라이언트에게 전송합니다. 클라이언트는 이 세션 ID를 사용하여 서버와 상호작용할 때마다 세션 정보를 전송한다.

##### 세션의 장점✅

- 서버가 클라이언트의 웹 브라우저에 의존하지 않아도 된다.
- 쿠키를 포함한 요청이 외부에 노출되어도 세션 ID 자체는 유의미한 개인 정보를 담지 않는다.
- 각 사용자마다 고유한 세션 ID가 발급되기 때문에, 요청이 들어올 때마다 회원 정보를 확인(로그인)할 필요 없다.

##### 세션의 단점❎

- 해커가 세션 ID를 중간에 탈취하여 클라이언트인 척 위장할 수 있다.
- 서버에서 세션 저장소를 사용하기 때문에, 요청이 많아지면 서버에 부하가 생긴다.

##### 쿠키 vs 세션

1. 상태 유지 방식

- 세션: 서버 측에서 상태 정보를 유지합니다. 사용자가 로그인하면 서버에서 세션을 생성하고, 세션 ID를 클라이언트에게 전송합니다. 클라이언트는 이 세션 ID를 사용하여 서버와 상호 작용할 때마다 세션 정보를 전송합니다.
- 토큰: 클라이언트 측에서 상태 정보를 유지합니다. 사용자가 로그인하면 서버에서 토큰을 생성하고, 이 토큰을 클라이언트에게 전송합니다. 클라이언트는 이 토큰을 사용하여 서버와 상호 작용할 때마다 인증 정보를 전송합니다.

2. 보안

- 세션: 세션 ID를 탈취하면 서버에 대한 권한 부여를 얻을 수 있습니다. 이를 방지하기 위해 HTTPS와 같은 암호화 프로토콜을 사용하여 세션 ID를 보호하는 것이 중요합니다.
- 토큰: 토큰은 서명되어 있기 때문에 클라이언트 측에서도 검증할 수 있습니다. 이를 통해 토큰이 위조되거나 변조되었는지 여부를 확인할 수 있습니다.

3. 확장성

- 세션: 세션은 서버 측에서 상태 정보를 유지하기 때문에 확장성이 제한될 수 있습니다. 세션 기반의 인증 및 권한 부여를 사용하면 서버의 부하 분산이 어려울 수 있습니다.
- 토큰: 토큰은 클라이언트 측에서 상태 정보를 유지하기 때문에 서버의 부하 분산이 쉬울 수 있습니다. 또한, 다양한 클라이언트 환경에서 사용할 수 있습니다.

### 🪙 토큰 (Token)

토큰(Token)은 인증(Authentication) 시스템에서 사용되는 문자열입니다. 일반적으로 사용자가 인증(Authentication)을 요청하면, 서버는 사용자의 인증 정보를 검증한 후, 사용자를 구분하기 위한 토큰을 발급합니다. 이 토큰은 클라이언트에게 전송되어, 이후 요청에서 사용됩니다.

토큰은 일반적으로 사용자의 인증 정보를 포함하지 않고, 단순히 사용자를 구분하기 위한 식별자로 사용됩니다. 따라서, 서버는 이 토큰을 사용하여 사용자를 인증하고, 권한을 부여합니다.

##### 토큰의 장점✅

1. 상태 정보 유지의 부담이 적음
   세션(Session)과 달리, 토큰은 서버에서 상태 정보를 유지하지 않으므로, 서버의 부하를 줄일 수 있습니다. 따라서, 토큰 기반의 인증 시스템은 대규모 분산 시스템에서 유용하게 사용됩니다.

2. 확장성이 높음
   토큰은 단순한 문자열로 구성되어 있으며, 이를 사용하여 서버 간 인증을 구현할 수 있습니다. 따라서, 토큰 기반의 인증 시스템은 다양한 클라이언트와 서버 간에 쉽게 확장될 수 있습니다.

3. 보안성이 높음
   토큰은 서버에서 인증 정보를 안전하게 전송하므로, 중간자 공격과 같은 보안 위협을 줄일 수 있습니다. 또한, JWT(JSON Web Token)와 같은 형식의 토큰은 서명과 암호화를 사용하여 안전하게 인증 정보를 전달할 수 있습니다.

4. 다양한 클라이언트 지원
   토큰 기반의 인증 시스템은 다양한 클라이언트를 지원합니다. 예를 들어, 모바일 애플리케이션, 웹 애플리케이션, 웹 서비스 등 다양한 클라이언트에서 쉽게 사용할 수 있습니다.

5. 사용자 경험 개선
   토큰 기반의 인증 시스템은 사용자가 재인증을 필요로 하지 않도록 하여, 사용자 경험을 개선할 수 있습니다. 따라서, 사용자가 자주 액세스하는 애플리케이션에서는 토큰 기반의 인증 시스템이 유용하게 사용됩니다.

##### 토큰의 단점❎

1. 토큰 유효기간 관리의 어려움
   토큰은 발급된 후에 일정 기간이 지나면 만료됩니다. 이 경우, 서버는 토큰의 유효기간을 관리해야 합니다. 유효기간을 관리하지 않으면, 만료된 토큰으로 인증을 시도할 수 있어 보안 문제가 발생할 수 있습니다.

2. 토큰 탈취에 대한 위험성
   토큰은 인증 정보를 담고 있는데, 이 정보가 탈취될 경우 보안 문제가 발생할 수 있습니다. 따라서, 토큰의 보안을 강화하기 위해서는 적절한 보안 기술을 사용하여 탈취를 예방하고 대응해야 합니다.

3. 토큰 크기의 한계
   토큰은 HTTP 요청의 헤더에 포함되어 전송되기 때문에, 토큰의 크기가 클 경우 HTTP 요청이 지연되는 문제가 발생할 수 있습니다. 이 경우, 토큰의 크기를 최소화하여 대역폭을 절약할 필요가 있습니다.

4. 토큰 관리의 복잡성
   토큰은 인증 정보를 담고 있기 때문에, 토큰 관리 시스템을 구현하고 관리하는 것이 중요합니다. 이를 위해서는 토큰의 생성, 발급, 갱신, 폐기 등에 대한 정책을 수립하고, 이를 실제로 구현하고 관리해야 합니다. 이는 관리의 복잡성을 증가시킬 수 있습니다.
